<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Google Sans', Arial, sans-serif;
      padding: 20px;
      background: #f8f9fa;
    }
    
    .container {
      max-width: 100%;
    }
    
    h2 {
      color: #1a73e8;
      margin-bottom: 20px;
      font-size: 20px;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    label {
      display: block;
      margin-bottom: 5px;
      color: #5f6368;
      font-size: 13px;
      font-weight: 500;
    }
    
    select, textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #dadce0;
      border-radius: 4px;
      font-size: 14px;
      font-family: inherit;
      transition: border-color 0.2s;
    }
    
    select:focus, textarea:focus {
      outline: none;
      border-color: #1a73e8;
    }
    
    textarea {
      resize: vertical;
      min-height: 120px;
    }
    
    .slider-container {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    input[type="range"] {
      flex: 1;
      height: 4px;
      border-radius: 2px;
      outline: none;
      -webkit-appearance: none;
      background: #dadce0;
    }
    
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: #1a73e8;
      cursor: pointer;
    }
    
    input[type="range"]::-moz-range-thumb {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: #1a73e8;
      cursor: pointer;
      border: none;
    }
    
    .slider-value {
      min-width: 35px;
      text-align: right;
      color: #5f6368;
      font-size: 13px;
    }
    
    button {
      width: 100%;
      padding: 12px;
      background: #1a73e8;
      color: white;
      border: none;
      border-radius: 4px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    button:hover {
      background: #1557b0;
    }
    
    button:disabled {
      background: #dadce0;
      cursor: not-allowed;
    }
    
    .response {
      margin-top: 20px;
      padding: 15px;
      background: white;
      border: 1px solid #dadce0;
      border-radius: 4px;
      min-height: 100px;
      max-height: 300px;
      overflow-y: auto;
      white-space: pre-wrap;
      word-wrap: break-word;
      font-size: 13px;
      line-height: 1.5;
      color: #202124;
      display: none;
    }
    
    .response.show {
      display: block;
    }
    
    .loading {
      text-align: center;
      color: #5f6368;
      padding: 20px;
      display: none;
    }
    
    .loading.show {
      display: block;
    }
    
    .spinner {
      border: 3px solid #f3f3f3;
      border-top: 3px solid #1a73e8;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      margin: 0 auto 10px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .error {
      background: #fce8e6;
      border-color: #c5221f;
      color: #c5221f;
    }
    
    .success {
      background: #e6f4ea;
      border-color: #137333;
      color: #137333;
    }
    
    .buttons-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 10px;
    }
    
    .btn-secondary {
      background: #5f6368;
    }
    
    .btn-secondary:hover {
      background: #3c4043;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>ü§ñ Groq LLM Assistant</h2>
    
    <div class="form-group">
      <label for="modelo">Modelo:</label>
      <select id="modelo">
        <option value="llama-3.3-70b-versatile">Llama 3.3 70B (Recomendado)</option>
        <option value="llama-3.1-8b-instant">Llama 3.1 8B (R√°pido)</option>
        <option value="mixtral-8x7b-32768">Mixtral 8x7B</option>
        <option value="gemma2-9b-it">Gemma 2 9B</option>
      </select>
    </div>
    
    <div class="form-group">
      <label for="temperatura">Temperatura: <span id="tempValue">0.7</span></label>
      <div class="slider-container">
        <input type="range" id="temperatura" min="0" max="2" step="0.1" value="0.7">
        <span class="slider-value">0.7</span>
      </div>
    </div>
    
    <div class="form-group">
      <label for="prompt">Pregunta / Prompt:</label>
      <textarea id="prompt" placeholder="Escribe tu pregunta aqu√≠..."></textarea>
    </div>
    
    <button id="ejecutar" onclick="ejecutarLLM()">Ejecutar</button>
    
    <div class="buttons-group">
      <button class="btn-secondary" onclick="limpiar()">Limpiar</button>
      <button class="btn-secondary" onclick="copiarRespuesta()">Copiar</button>
    </div>
    
    <div class="loading" id="loading">
      <div class="spinner"></div>
      <p>Procesando...</p>
    </div>
    
    <div class="response" id="response"></div>
  </div>

  <script>
    // Actualizar valor de temperatura
    const tempSlider = document.getElementById('temperatura');
    const tempValue = document.querySelector('.slider-value');
    
    tempSlider.addEventListener('input', function() {
      tempValue.textContent = this.value;
    });
    
    // Ejecutar LLM
    function ejecutarLLM() {
      const prompt = document.getElementById('prompt').value.trim();
      const modelo = document.getElementById('modelo').value;
      const temperatura = parseFloat(document.getElementById('temperatura').value);
      
      if (!prompt) {
        mostrarError('Por favor ingresa un prompt');
        return;
      }
      
      // Mostrar loading
      document.getElementById('loading').classList.add('show');
      document.getElementById('response').classList.remove('show');
      document.getElementById('ejecutar').disabled = true;
      
      // Llamar a la funci√≥n de Apps Script
      google.script.run
        .withSuccessHandler(function(resultado) {
          mostrarRespuesta(resultado);
          document.getElementById('loading').classList.remove('show');
          document.getElementById('ejecutar').disabled = false;
        })
        .withFailureHandler(function(error) {
          mostrarError(error.message);
          document.getElementById('loading').classList.remove('show');
          document.getElementById('ejecutar').disabled = false;
        })
        .llamarGroqAPI(prompt, modelo, temperatura);
    }
    
    // Mostrar respuesta
    function mostrarRespuesta(texto) {
      const responseDiv = document.getElementById('response');
      responseDiv.textContent = texto;
      responseDiv.classList.add('show', 'success');
      responseDiv.classList.remove('error');
    }
    
    // Mostrar error
    function mostrarError(mensaje) {
      const responseDiv = document.getElementById('response');
      responseDiv.textContent = '‚ùå ' + mensaje;
      responseDiv.classList.add('show', 'error');
      responseDiv.classList.remove('success');
    }
    
    // Limpiar formulario
    function limpiar() {
      document.getElementById('prompt').value = '';
      document.getElementById('response').classList.remove('show');
      document.getElementById('modelo').value = 'llama-3.3-70b-versatile';
      document.getElementById('temperatura').value = 0.7;
      document.querySelector('.slider-value').textContent = '0.7';
    }
    
    // Copiar respuesta
    function copiarRespuesta() {
      const responseDiv = document.getElementById('response');
      if (responseDiv.classList.contains('show')) {
        const texto = responseDiv.textContent;
        navigator.clipboard.writeText(texto).then(function() {
          alert('‚úÖ Respuesta copiada al portapapeles');
        }).catch(function(err) {
          alert('‚ùå Error al copiar: ' + err);
        });
      } else {
        alert('‚ö†Ô∏è No hay respuesta para copiar');
      }
    }
    
    // Ejecutar con Enter (Ctrl+Enter)
    document.getElementById('prompt').addEventListener('keydown', function(e) {
      if (e.ctrlKey && e.key === 'Enter') {
        ejecutarLLM();
      }
    });
  </script>
</body>
</html>